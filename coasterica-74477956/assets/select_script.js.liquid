var instagramData=[],selectedImages=[],customerOrder=new Object,product_variant=328766209;Shopify.addItem=function(e,t,r,a,s,i,o,l,n,c,m,d,u,g,p,h,_,$,f,O){var t=t||1,v={type:"POST",url:"/cart/add.js",data:"quantity="+t+"&id="+e+"&properties[ig_name]="+r+"&properties[_img_1_id]="+a+"&properties[_img_2_id]="+s+"&properties[_img_3_id]="+i+"&properties[_img_4_id]="+o+"&properties[_img_1_url]="+l+"&properties[_img_2_url]="+n+"&properties[_img_3_url]="+c+"&properties[_img_4_url]="+m+"&properties[_img_1_thumbnail]="+d+"&properties[_img_2_thumbnail]="+u+"&properties[_img_3_thumbnail]="+g+"&properties[_img_4_thumbnail]="+p+"&properties[_img_1_crop]="+h+"&properties[_img_2_crop]="+_+"&properties[_img_3_crop]="+$+"&properties[_img_4_crop]="+f+"&attributes[ig_name]="+r,dataType:"json",success:function(e){"function"==typeof O?O(e):Shopify.onItemAdded(e)},error:function(e,t){Shopify.onError(e,t)}};jQuery.ajax(v)},$(function(){function e(){var e={access_token:o,count:50};t(e,r)}function t(e,t){var r="https://api.instagram.com/v1/users/self/media/recent?callback=?";$.getJSON(r,e,t)}function r(e){if(200==e.meta.code){instagramData=[],instagramData=e;var t=instagramData.data;if(t.length>0){var r=document.createElement("ul");$.tmpl("instagramPics",t).appendTo(r),$(r).appendTo("#image_content #images").hide(),$("#instagram-logged-in-as").html("Logged in as @"+t[0].user.username+'. <a href="http://instagram.com/accounts/logout/ ">Log Out</a>'),$("#images ul img").load(function(){n&&($("#select h1.loading").fadeOut(250),$("#instagram-logged-in-as").show(),n=!1),$(r).fadeIn(500)})}else $("#select h1.loading").html("Sorry, you have no Instagram images");l=!1}else $("#select h1.loading").html("Sorry, there's been a problem. Please refresh the page.")}function a(){if(instagramData.pagination.next_max_id){if($("h1.loadingMore").html("Loading more imagesâ€¦"),l===!1){var e={access_token:o,max_id:instagramData.pagination.next_max_id};l=!0,t(e,r)}}else $("h1.loadingMore").html("")}function s(){window.location=document.getElementById("shop-url").innerHTML+"/cart"}$("#shortlist_container").sticky({topSpacing:0}),customerOrder.userInfo=[],customerOrder.imageFullObjects=[],customerOrder.images=[],customerOrder.delivery=[],customerOrder.access_token="",$.template("instagramPics",'<li><a href="#"><img src="${images.low_resolution.url}" /></a></li>'),$.template("selectedPics",'<li style="background-image: url(${images.low_resolution.url});"><a class="remove-link" href="#" title="remove coasters from cart">Remove</a><a class="crop" crop-toggle="virgin" style="cursor: pointer; position:absolute; z-index:10; left: 0;">crop</a></li>');var i=window.location.hash;i=i.split("=");var o=i[1];customerOrder.access_token=o,e();var l=!1,n=!0,c=null,m=[],d=4;d>0&&$(window).scroll(function(){$(window).scrollTop()>=$(document).height()-window.innerHeight-500&&a()}),$("#image_content #images").on("click","ul li a",function(e){e.preventDefault(),m.length<=3&&(c=$.tmplItem(this),selectedData=c.data,0==m.length&&(customerOrder.userInfo=c.data.user),m.push(c.data.images.standard_resolution.url),$("#shortlist li.empty:last-child").remove(),$.tmpl("selectedPics",selectedData).prependTo("#shortlist ul"),d-=1,$("h1#select-image-count").html(1==d?"Select <span>"+d+"</span> Image":"Select <span>"+d+"</span> Images"),$(this).parent("li").addClass("shortlisted"),$(this).attr("id",m.length),4>d&&($("#msg-border").hide(),$("#instagram-logged-in-as").hide(),$("#select-image-count").addClass("select-image-count-mid-selection")),4==m.length&&($("h1#select-image-count").removeClass("select-image-count-mid-selection"),$("h1#select-image-count").html('<a href="#" class="next-step btn">Add to cart</a>'),$("h1#select-image-count").hide(),$("div.cart-or-crop").fadeIn(),$(".sticky-wrapper").height(330)))}),$("#shortlist").on("click","a.remove-link",function(e){e.preventDefault(),c=$.tmplItem(this),selectedData=c.data;var t=$("this").attr("id");m.splice(t,1),-1==$.inArray(c.data.images.standard_resolution.url,m)&&$('#image_content #images ul li a img[src="'+c.data.images.thumbnail.url+'"]').parents("li").removeClass("shortlisted"),$(this).parent().remove(),$("#shortlist ul").append('<li class="empty"></li>'),d+=1,1==d?($("h1#select-image-count").html("Select <span>"+d+"</span> Image"),$("div.cart-or-crop").fadeOut(),$(".sticky-wrapper").height(270),$("h1#select-image-count").addClass("select-image-count-mid-selection"),$("h1#select-image-count").show()):$("h1#select-image-count").html("Select <span>"+d+"</span> Images"),4==d&&($("#msg-border").show(),$("#select-image-count").removeClass("select-image-count-mid-selection"))}),$("#shortlist").on("click","a.crop",function(e){e.preventDefault(),"virgin"==$(this).attr("crop-toggle")?(parentLi=$(this).parent("li"),c=$.tmplItem(this),selectedData=c.data,selectedImgUrl=selectedData.images.standard_resolution.url,$(parentLi).attr("style","background-image: url("+selectedImgUrl+")").addClass("border-cropped"),$(this).siblings("img").hide(),$(this).attr("crop-toggle","on")):"on"==$(this).attr("crop-toggle")?($(parentLi).removeClass("border-cropped"),$(this).attr("crop-toggle","off")):"off"==$(this).attr("crop-toggle")&&($(parentLi).addClass("border-cropped"),$(this).attr("crop-toggle","on"))}),$("a#add-to-cart").on("click",function(e){e.preventDefault(),customerOrder.images=[],customerOrder.crop=[],$("#shortlist ul li").each(function(e){var t=$.tmplItem(this).data;customerOrder.imageFullObjects.push(t),customerOrder.images.push(t.images),toCrop=$(this).hasClass("border-cropped"),customerOrder.crop[e]=toCrop?1:0});var t=customerOrder.userInfo.username,r=customerOrder.imageFullObjects[0].id,a=customerOrder.images[0].standard_resolution.url,i=customerOrder.images[0].thumbnail.url,o=customerOrder.crop[0],l=customerOrder.imageFullObjects[1].id,n=customerOrder.images[1].standard_resolution.url,c=customerOrder.images[1].thumbnail.url,m=customerOrder.crop[1],d=customerOrder.imageFullObjects[2].id,u=customerOrder.images[2].standard_resolution.url,g=customerOrder.images[2].thumbnail.url,p=customerOrder.crop[2],h=customerOrder.imageFullObjects[3].id,_=customerOrder.images[3].standard_resolution.url,f=customerOrder.images[3].thumbnail.url,O=customerOrder.crop[3];Shopify.addItem(product_variant,1,t,r,l,d,h,a,n,u,_,i,c,g,f,o,m,p,O,s)})});