(function(e){function c(t,n,r,o){var u={data:o||(n?n.data:{}),_wrap:n?n._wrap:null,tmpl:null,parent:n||null,nodes:[],calls:b,nest:w,wrap:E,html:S,update:x};t&&e.extend(u,t,{nodes:[],parent:n});if(r){u.tmpl=r;u._ctnt=u._ctnt||u.tmpl(e,u);u.key=++a;(l.length?s:i)[a]=u}return u}function h(t,r,i){var s,o=i?e.map(i,function(e){return typeof e==="string"?t.key?e.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+n+'="'+t.key+'" $2'):e:h(e,t,e._ctnt)}):t;if(r)return o;o=o.join("");o.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(t,n,r,i){s=e(r).get();y(s);if(n)s=p(n).concat(s);if(i)s=s.concat(p(i))});return s?s:p(o)}function p(t){var n=document.createElement("div");n.innerHTML=t;return e.makeArray(n.childNodes)}function d(t){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+e.trim(t).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(t,n,r,i,s,o,u){var a=e.tmpl.tag[r],f,l,c;if(!a)throw"Template command not found: "+r;f=a._default||[];if(o&&!/\w$/.test(s)){s+=o;o=""}if(s){s=m(s);u=u?","+m(u)+")":o?")":"";l=o?s.indexOf(".")>-1?s+o:"("+s+").call($item"+u:s;c=o?l:"(typeof("+s+")==='function'?("+s+").call($item):("+s+"))"}else c=l=f.$1||"null";i=m(i);return"');"+a[n?"close":"open"].split("$notnull_1").join(s?"typeof("+s+")!=='undefined' && ("+s+")!=null":"true").split("$1a").join(c).split("$1").join(l).split("$2").join(i?i.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function(e,t,n,r){r=r?","+r+")":n?")":"";return r?"("+t+").call($item"+r:e}):f.$2||"")+"_.push('"})+"');}return _;")}function v(t,n){t._wrap=h(t,true,e.isArray(n)?n:[r.test(n)?n:e(n).html()]).join("")}function m(e){return e?e.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function g(e){var t=document.createElement("div");t.appendChild(e.cloneNode(true));return t.innerHTML}function y(t){function v(t){function v(e){e=e+r;p=l[e]=l[e]||c(p,i[p.parent.key+r]||p.parent,null,true)}var o,u=t,h,p,d;if(d=t.getAttribute(n)){while(u.parentNode&&(u=u.parentNode).nodeType===1&&!(o=u.getAttribute(n)));if(o!==d){u=u.parentNode?u.nodeType===11?0:u.getAttribute(n)||0:0;if(!(p=i[d])){p=s[d];p=c(p,i[u]||s[u],null,true);p.key=++a;i[a]=p}f&&v(d)}t.removeAttribute(n)}else if(f&&(p=e.data(t,"tmplItem"))){v(p.key);i[p.key]=p;u=e.data(t.parentNode,"tmplItem");u=u?u.key:0}if(p){h=p;while(h&&h.key!=u){h.nodes.push(t);h=h.parent}delete p._ctnt;delete p._wrap;e.data(t,"tmplItem",p)}}var r="_"+f,o,u,l={},h,p,d;for(h=0,p=t.length;h<p;h++){if((o=t[h]).nodeType!==1)continue;u=o.getElementsByTagName("*");for(d=u.length-1;d>=0;d--)v(u[d]);v(o)}}function b(e,t,n,r){if(!e)return l.pop();l.push({_:e,tmpl:t,item:this,data:n,options:r})}function w(t,n,r){return e.tmpl(e.template(t),n,r,this)}function E(t,n){var r=t.options||{};r.wrapped=n;return e.tmpl(e.template(t.tmpl),t.data,r,t.item)}function S(t,n){var r=this._wrap;return e.map(e(e.isArray(r)?r.join(""):r).filter(t||"*"),function(e){return n?e.innerText||e.textContent:e.outerHTML||g(e)})}function x(){var t=this.nodes;e.tmpl(null,null,null,this).insertBefore(t[0]);e(t).remove()}var t=e.fn.domManip,n="_tmplitem",r=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,i={},s={},o,u={key:0,data:{}},a=0,f=0,l=[];e.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,n){e.fn[t]=function(r){var s=[],u=e(r),a,l,c,h,p=this.length===1&&this[0].parentNode;o=i||{};if(p&&p.nodeType===11&&p.childNodes.length===1&&u.length===1){u[n](this[0]);s=this}else{for(l=0,c=u.length;l<c;l++){f=l;a=(l>0?this.clone(true):this).get();e.fn[n].apply(e(u[l]),a);s=s.concat(a)}f=0;s=this.pushStack(s,t,u.selector)}h=o;o=null;e.tmpl.complete(h);return s}});e.fn.extend({tmpl:function(t,n,r){return e.tmpl(this[0],t,n,r)},tmplItem:function(){return e.tmplItem(this[0])},template:function(t){return e.template(t,this[0])},domManip:function(n,r,s){if(n[0]&&n[0].nodeType){var u=e.makeArray(arguments),a=n.length,l=0,c;while(l<a&&!(c=e.data(n[l++],"tmplItem")));if(a>1)u[0]=[e.makeArray(n)];if(c&&f)u[2]=function(t){e.tmpl.afterManip(this,t,s)};t.apply(this,u)}else t.apply(this,arguments);f=0;!o&&e.tmpl.complete(i);return this}});e.extend({tmpl:function(t,n,r,o){var a,f=!o;if(f){o=u;t=e.template[t]||e.template(null,t);s={}}else if(!t){t=o.tmpl;i[o.key]=o;o.nodes=[];o.wrapped&&v(o,o.wrapped);return e(h(o,null,o.tmpl(e,o)))}if(!t)return[];if(typeof n==="function")n=n.call(o||{});r&&r.wrapped&&v(r,r.wrapped);a=e.isArray(n)?e.map(n,function(e){return e?c(r,o,t,e):null}):[c(r,o,t,n)];return f?e(h(o,null,a)):a},tmplItem:function(t){var n;if(t instanceof e)t=t[0];while(t&&t.nodeType===1&&!(n=e.data(t,"tmplItem"))&&(t=t.parentNode));return n||u},template:function(t,n){if(n){if(typeof n==="string")n=d(n);else if(n instanceof e)n=n[0]||{};if(n.nodeType)n=e.data(n,"tmpl")||e.data(n,"tmpl",d(n.innerHTML));return typeof t==="string"?e.template[t]=n:n}return t?typeof t!=="string"?e.template(null,t):e.template[t]||e.template(null,r.test(t)?t:e(t)):null},encode:function(e){return(""+e).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});e.extend(e.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(){i={}},afterManip:function(t,n,r){var i=n.nodeType===11?e.makeArray(n.childNodes):n.nodeType===1?[n]:[];r.call(t,n);y(i);f++}})})(jQuery);var JSON;if(!JSON){JSON={}}(function(){function f(e){return e<10?"0"+e:e}function quote(e){escapable.lastIndex=0;return escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t==="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];if(a&&typeof a==="object"&&typeof a.toJSON==="function"){a=a.toJSON(e)}if(typeof rep==="function"){a=rep.call(t,e,a)}switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a){return"null"}gap+=indent;u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1){u[n]=str(n,a)||"null"}i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]";gap=o;return i}if(rep&&typeof rep==="object"){s=rep.length;for(n=0;n<s;n+=1){if(typeof rep[n]==="string"){r=rep[n];i=str(r,a);if(i){u.push(quote(r)+(gap?": ":":")+i)}}}}else{for(r in a){if(Object.prototype.hasOwnProperty.call(a,r)){i=str(r,a);if(i){u.push(quote(r)+(gap?": ":":")+i)}}}}i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}";gap=o;return i}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;if(typeof JSON.stringify!=="function"){JSON.stringify=function(e,t,n){var r;gap="";indent="";if(typeof n==="number"){for(r=0;r<n;r+=1){indent+=" "}}else{if(typeof n==="string"){indent=n}}rep=t;if(t&&typeof t!=="function"&&(typeof t!=="object"||typeof t.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":e})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i==="object"){for(n in i){if(Object.prototype.hasOwnProperty.call(i,n)){r=walk(i,n);if(r!==undefined){i[n]=r}else{delete i[n]}}}}return reviver.call(e,t,i)}var j;text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}})();(function(e){var t={topSpacing:0,bottomSpacing:0,className:"is-sticky",wrapperClassName:"sticky-wrapper",center:false,getWidthFrom:"",responsiveWidth:false},n=e(window),r=e(document),i=[],s=n.height(),o=function(){var t=n.scrollTop(),o=r.height(),u=o-s,a=t>u?u-t:0;for(var f=0;f<i.length;f++){var l=i[f],c=l.stickyWrapper.offset().top,h=c-l.topSpacing-a;if(t<=h){if(l.currentTop!==null){l.stickyElement.css("position","").css("top","");l.stickyElement.trigger("sticky-end",[l]).parent().removeClass(l.className);l.currentTop=null}}else{var p=o-l.stickyElement.outerHeight()-l.topSpacing-l.bottomSpacing-t-a;if(p<0){p=p+l.topSpacing}else{p=l.topSpacing}if(l.currentTop!=p){l.stickyElement.css("position","fixed").css("top",p);if(typeof l.getWidthFrom!=="undefined"){l.stickyElement.css("width",e(l.getWidthFrom).width())}l.stickyElement.trigger("sticky-start",[l]).parent().addClass(l.className);l.currentTop=p}}}},u=function(){s=n.height();for(var t=0;t<i.length;t++){var r=i[t];if(typeof r.getWidthFrom!=="undefined"&&r.responsiveWidth===true){r.stickyElement.css("width",e(r.getWidthFrom).width())}}},a={init:function(n){var r=e.extend({},t,n);return this.each(function(){var n=e(this);var s=n.attr("id");var o=s?s+"-"+t.wrapperClassName:t.wrapperClassName;var u=e("<div></div>").attr("id",s+"-sticky-wrapper").addClass(r.wrapperClassName);n.wrapAll(u);if(r.center){n.parent().css({width:n.outerWidth(),marginLeft:"auto",marginRight:"auto"})}if(n.css("float")=="right"){n.css({"float":"none"}).parent().css({"float":"right"})}var a=n.parent();a.css("height",n.outerHeight());i.push({topSpacing:r.topSpacing,bottomSpacing:r.bottomSpacing,stickyElement:n,currentTop:null,stickyWrapper:a,className:r.className,getWidthFrom:r.getWidthFrom,responsiveWidth:r.responsiveWidth})})},update:o,unstick:function(t){return this.each(function(){var t=e(this);var n=-1;for(var r=0;r<i.length;r++){if(i[r].stickyElement.get(0)==t.get(0)){n=r}}if(n!=-1){i.splice(n,1);t.unwrap();t.removeAttr("style")}})}};if(window.addEventListener){window.addEventListener("scroll",o,false);window.addEventListener("resize",u,false)}else if(window.attachEvent){window.attachEvent("onscroll",o);window.attachEvent("onresize",u)}e.fn.sticky=function(t){if(a[t]){return a[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return a.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.sticky")}};e.fn.unstick=function(t){if(a[t]){return a[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return a.unstick.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.sticky")}};e(function(){setTimeout(o,0)})})(jQuery);var instagramData=[];var selectedImages=[];var customerOrder=new Object;var product_variant=858193943;Shopify.addItem=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){var t=t||1;var w={type:"POST",url:"/cart/add.js",data:"quantity="+t+"&id="+e+"&properties[ig_name]="+n+"&properties[img_1_id]="+r+"&properties[img_2_id]="+i+"&properties[img_3_id]="+s+"&properties[img_4_id]="+o+"&properties[img_1_url]="+u+"&properties[img_2_url]="+a+"&properties[img_3_url]="+f+"&properties[img_4_url]="+l+"&properties[img_1_thumbnail]="+c+"&properties[img_2_thumbnail]="+h+"&properties[img_3_thumbnail]="+p+"&properties[img_4_thumbnail]="+d+"&properties[img_1_crop]="+v+"&properties[img_2_crop]="+m+"&properties[img_3_crop]="+g+"&properties[img_4_crop]="+y+"&attributes[ig_name]="+n,dataType:"json",success:function(e){if(typeof b==="function"){b(e)}else{Shopify.onItemAdded(e)}},error:function(e,t){Shopify.onError(e,t)}};jQuery.ajax(w)};$(function(){function n(){var e={access_token:t,count:50};r(e,o)}function r(e,t){var n="https://api.instagram.com/v1/users/self/media/recent?callback=?";$.getJSON(n,e,t)}function o(e){if(e.meta.code==200){instagramData=[];instagramData=e;var t=instagramData.data;if(t.length>0){var n=document.createElement("ul");$.tmpl("instagramPics",t).appendTo(n);$(n).appendTo("#image_content #images").hide();$("#instagram-logged-in-as").html("Logged in as @"+t[0].user.username+' <a href="http://instagram.com/accounts/logout/ ">Log Out</a>');$("#images ul img").load(function(){if(s){$("#select h1.loading").fadeOut(250);$("#instagram-logged-in-as").fadeIn(250);s=false}$(n).fadeIn(500)})}else{$("#select h1.loading").html("Sorry, you have no Instagram images")}i=false}else{$("#select h1.loading").html("Sorry, there's been a problem. Please refresh the page.")}}function l(){if(instagramData.pagination.next_max_id){$("h1.loadingMore").html("Loading more imagesâ€¦");if(i===false){var e={access_token:t,max_id:instagramData.pagination.next_max_id};i=true;r(e,o)}}else{$("h1.loadingMore").html("")}}function c(){window.location=document.getElementById("shop-url").innerHTML+"/cart"}$("#shortlist_container").sticky({topSpacing:0});customerOrder.userInfo=[];customerOrder.imageFullObjects=[];customerOrder.images=[];customerOrder.delivery=[];customerOrder.access_token="";$.template("instagramPics",'<li><a href="#"><img src="${images.low_resolution.url}" /></a></li>');$.template("selectedPics",'<li style="background-image: url(${images.low_resolution.url});"><a class="remove-link" href="#" title="remove coasters from cart">Remove</a><a class="crop" crop-toggle="virgin" style="cursor: pointer; position:absolute; z-index:10; left: 0;">crop</a></li>');var e=window.location.hash;e=e.split("=");var t=e[1];customerOrder.access_token=t;n();var i=false;var s=true;var u=null;var a=[];var f=4;if(f>0){$(window).scroll(function(){if($(window).scrollTop()>=$(document).height()-window.innerHeight-500){l()}})}$("#image_content #images").on("click","ul li a",function(e){e.preventDefault();if(a.length<=3){u=$.tmplItem(this);selectedData=u.data;if(a.length==0){customerOrder.userInfo=u.data.user}a.push(u.data.images.standard_resolution.url);$("#shortlist li.empty:last-child").remove();$.tmpl("selectedPics",selectedData).prependTo("#shortlist ul");f=f-1;if(f==1){$("h1#select-image-count").html("Select <span>"+f+"</span> Image")}else{$("h1#select-image-count").html("Select <span>"+f+"</span> Images")}$(this).parent("li").addClass("shortlisted");$(this).attr("id",a.length);if(f<4){$("#msg-border").hide();$("#instagram-logged-in-as").hide();$("#select-image-count").addClass("select-image-count-mid-selection")}if(a.length==4){$("h1#select-image-count").removeClass("select-image-count-mid-selection");$("h1#select-image-count").html('<a href="#" class="next-step btn">Add to cart</a>');$("h1#select-image-count").hide();$("div.cart-or-crop").fadeIn();$(".sticky-wrapper").height(330)}}});$("#shortlist").on("click","a.remove-link",function(e){e.preventDefault();u=$.tmplItem(this);selectedData=u.data;var t=$("this").attr("id");a.splice(t,1);if($.inArray(u.data.images.standard_resolution.url,a)==-1){$('#image_content #images ul li a img[src="'+u.data.images.thumbnail.url+'"]').parents("li").removeClass("shortlisted")}$(this).parent().remove();$("#shortlist ul").append('<li class="empty"></li>');f=f+1;if(f==1){$("h1#select-image-count").html("Select <span>"+f+"</span> Image");$("div.cart-or-crop").fadeOut();$(".sticky-wrapper").height(270);$("h1#select-image-count").addClass("select-image-count-mid-selection");$("h1#select-image-count").show()}else{$("h1#select-image-count").html("Select <span>"+f+"</span> Images")}if(f==4){$("#msg-border").show();$("#select-image-count").removeClass("select-image-count-mid-selection")}});$("#shortlist").on("click","a.crop",function(e){e.preventDefault();if($(this).attr("crop-toggle")=="virgin"){parentLi=$(this).parent("li");u=$.tmplItem(this);selectedData=u.data;selectedImgUrl=selectedData.images.standard_resolution.url;$(parentLi).attr("style","background-image: url("+selectedImgUrl+")").addClass("border-cropped");$(this).siblings("img").hide();$(this).attr("crop-toggle","on")}else if($(this).attr("crop-toggle")=="on"){$(parentLi).removeClass("border-cropped");$(this).attr("crop-toggle","off")}else if($(this).attr("crop-toggle")=="off"){$(parentLi).addClass("border-cropped");$(this).attr("crop-toggle","on")}});$("a#add-to-cart").on("click",function(e){e.preventDefault();customerOrder.images=[];customerOrder.crop=[];$("#shortlist ul li").each(function(e){var t=$.tmplItem(this).data;customerOrder.imageFullObjects.push(t);customerOrder.images.push(t.images);toCrop=$(this).hasClass("border-cropped");if(toCrop){customerOrder.crop[e]=1}else{customerOrder.crop[e]=0}});var t=customerOrder.userInfo.username;var n=customerOrder.imageFullObjects[0].id;var r=customerOrder.images[0].standard_resolution.url;var i=customerOrder.images[0].thumbnail.url;var s=customerOrder.crop[0];var o=customerOrder.imageFullObjects[1].id;var u=customerOrder.images[1].standard_resolution.url;var a=customerOrder.images[1].thumbnail.url;var f=customerOrder.crop[1];var l=customerOrder.imageFullObjects[2].id;var h=customerOrder.images[2].standard_resolution.url;var p=customerOrder.images[2].thumbnail.url;var d=customerOrder.crop[2];var v=customerOrder.imageFullObjects[3].id;var m=customerOrder.images[3].standard_resolution.url;var g=customerOrder.images[3].thumbnail.url;var y=customerOrder.crop[3];Shopify.addItem(product_variant,1,t,n,o,l,v,r,u,h,m,i,a,p,g,s,f,d,y,c)})})